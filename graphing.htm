<html>
	<head></head>
	<body>
		<canvas id="can" width="500" height="500"></canvas>
		<script>
		var canvas = document.getElementById("can");
		var ctx = canvas.getContext("2d");
		ctx.beginPath();
		//ctx.moveTo(0, f(0) );
		var scale = 500;
		var finalX,jump = false;

		(function(){
			function func(x){ 
				var r = ( Math.tan(x * Math.PI/2  )/30)/3 + ( Math.pow(x,(1/2)) )/3 +( Math.pow(x,45) )/3;
				return r; 
			}
			var controlPointRapid = 30;

			ctx.strokeStyle = "#000000";
			ctx.lineWidth = 1;
			
			var pointCount = Math.floor( func(Math.random())*controlPointRapid )+5;
			var controlPoints = [];
			var height;

			var pyramid = [];

			for(var i = 0; i <pointCount; i+=1){
				controlPoints.push({x:i,y:func( Math.random() )});
			}
			pyramid[0] = controlPoints;

			var j;
			for(i = 1; i < pointCount; i+=1){
				pyramid[i] = [];
				for(j =0; j< pointCount-i;j+=1){
					pyramid[i].push({});
				}
			} 

			var resolution = 100;
			var k,X,Y;
			if(0){
				ctx.moveTo(scale/2,scale/2 );
				for(k=0; k<pyramid[0].length; k+=1){
					ctx.lineTo( scale/2 + pyramid[0][k].x/pointCount * scale/2 , scale/2 - pyramid[0][k].y*scale/2 );
				}
			}

			ctx.stroke();

			ctx.beginPath()
			ctx.strokeStyle = "#888888";
			ctx.lineWidth = 3;
			for( i = 0; i<=resolution; i+=1){
				//ctx.moveTo(scale/2,scale/2 );
				for( j = 1; j < pyramid.length ; j+=1){
					for(k=0; k<pyramid[j].length; k+=1){
						var x0 = pyramid[j-1][k].x;
						var x1 = pyramid[j-1][k+1].x;
						var y0 = pyramid[j-1][k].y;
						var y1 = pyramid[j-1][k+1].y;

						pyramid[j][k].x = x0 + (x1 - x0)*(i/resolution);
						pyramid[j][k].y = y0 + (y1 - y0)*(i/resolution);
					}
				}
				
				X = (scale/2) + (pyramid[j-1][0].x/pointCount) * scale/2;
				Y = (scale/2) - pyramid[j-1][0].y * scale/2;

				ctx.lineTo(X ,Y );
			}
		})();
		/*function f(x){
			var r = Math.tan(x*Math.PI/2)/2.9;
			if(x!=1){
				console.log(r);
				return r;
			}
			console.log("END");
			console.log( r);	
			return null;
		}
		
		ctx.moveTo(scale/2+0*scale, scale/2-0*scale );
		for(var x = 0-.99999; x <= 1; x+=0.01){
			finalX = f(x);
			if(finalX === null){
				jump = true;
			}else{
				if(jump)
					ctx.moveTo(scale/2+x*scale, scale/2-finalX*scale );
				ctx.lineTo(scale/2+x*scale,scale/2-finalX*scale);	
				jump = false;
			}
		}*/
		/*ctx.strokeStyle = "#222222";
		ctx.lineWidth = 1;*/
		ctx.moveTo(0, scale/2);
		ctx.lineTo(scale,scale/2);	

		ctx.moveTo(scale/2,0 );
		ctx.lineTo(scale/2,scale);	
		ctx.stroke();
		</script>
	</body>
</html>